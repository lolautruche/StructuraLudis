erDiagram
    %% ===== ORGANIZATION DOMAIN =====
    Organization {
        uuid id PK
        string name
        string slug UK
        string legal_registration_number
        string contact_email
        datetime created_at
        datetime updated_at
    }

    UserGroup {
        uuid id PK
        uuid organization_id FK
        string name
        enum type "STAFF|ASSOCIATION|EXHIBITOR|PLAYER_CLUB"
        boolean is_public
        datetime created_at
        datetime updated_at
    }

    GroupPermission {
        uuid id PK
        uuid user_group_id FK
        string resource
        string action
    }

    %% ===== USER DOMAIN =====
    User {
        uuid id PK
        string email UK
        string hashed_password
        string full_name
        enum global_role "SUPER_ADMIN|ORGANIZER|PARTNER|USER"
        string timezone
        string locale
        boolean is_active
        datetime last_login
        datetime created_at
        datetime updated_at
    }

    UserGroupMembership {
        uuid id PK
        uuid user_id FK
        uuid user_group_id FK
        enum group_role "OWNER|ADMIN|MEMBER"
        datetime joined_at
    }

    %% ===== EXHIBITION DOMAIN =====
    Exhibition {
        uuid id PK
        uuid organization_id FK
        string title
        string slug UK
        text description
        datetime start_date
        datetime end_date
        string timezone
        int grace_period_minutes
        string location_name
        string address
        string city
        string country_code
        jsonb settings
        enum status "DRAFT|PUBLISHED|ARCHIVED"
        boolean is_registration_open "Issue 39"
        datetime registration_opens_at "Issue 39"
        datetime registration_closes_at "Issue 39"
        string primary_language "Issue 39"
        jsonb secondary_languages "Issue 39"
        datetime created_at
        datetime updated_at
    }

    TimeSlot {
        uuid id PK
        uuid exhibition_id FK
        string name
        datetime start_time
        datetime end_time
        int max_duration_minutes
        int buffer_time_minutes
        datetime created_at
        datetime updated_at
    }

    Zone {
        uuid id PK
        uuid exhibition_id FK
        uuid delegated_to_group_id FK "nullable - Partner delegation"
        string name
        text description
        enum type "RPG|BOARD_GAME|WARGAME|TCG|DEMO|MIXED"
        datetime created_at
        datetime updated_at
    }

    PhysicalTable {
        uuid id PK
        uuid zone_id FK
        string label
        int capacity
        enum status "AVAILABLE|OCCUPIED|RESERVED|MAINTENANCE"
        datetime created_at
        datetime updated_at
    }

    SafetyTool {
        uuid id PK
        uuid exhibition_id FK
        string name
        string slug
        text description
        string url
        boolean is_required
        int display_order
        datetime created_at
        datetime updated_at
    }

    %% ===== GAME DOMAIN =====
    GameCategory {
        uuid id PK
        string name
        string slug UK
    }

    Game {
        uuid id PK
        uuid category_id FK
        string title
        string external_provider_id "GROG sync"
        string publisher
        text description
        enum complexity "BEGINNER|INTERMEDIATE|EXPERT"
        int min_players
        int max_players
        datetime created_at
        datetime updated_at
    }

    GameSession {
        uuid id PK
        uuid exhibition_id FK
        uuid time_slot_id FK
        uuid physical_table_id FK "nullable"
        uuid game_id FK
        uuid provided_by_group_id FK "nullable - Partner"
        uuid created_by_user_id FK
        string title
        text description
        string language
        int min_age
        int max_players_count
        jsonb safety_tools "Selected tools slugs"
        boolean is_accessible_disability
        enum status "DRAFT|PENDING_MODERATION|CHANGES_REQUESTED|VALIDATED|REJECTED|IN_PROGRESS|FINISHED|CANCELLED"
        string rejection_reason
        datetime scheduled_start
        datetime scheduled_end
        datetime gm_checked_in_at
        datetime actual_start
        datetime actual_end
        int actual_player_count "Issue 35 - Session report"
        string table_condition "Issue 35 - CLEAN|NEEDS_CLEANING|DAMAGED"
        string end_notes "Issue 35 - Session report notes"
        datetime created_at
        datetime updated_at
    }

    Booking {
        uuid id PK
        uuid game_session_id FK
        uuid user_id FK
        enum role "GM|PLAYER|ASSISTANT|SPECTATOR"
        enum status "PENDING|CONFIRMED|WAITING_LIST|CHECKED_IN|ATTENDED|NO_SHOW|CANCELLED"
        datetime checked_in_at
        datetime registered_at
        datetime updated_at
    }

    ModerationComment {
        uuid id PK
        uuid game_session_id FK
        uuid user_id FK
        string content "max 2000 chars"
        datetime created_at
        datetime updated_at
    }

    %% ===== MEDIA DOMAIN =====
    Media {
        uuid id PK
        uuid uploaded_by_user_id FK
        string filename
        string content_type
        string storage_path
        int file_size
        datetime created_at
    }

    AuditLog {
        uuid id PK
        string entity_type
        uuid entity_id
        string action
        uuid user_id FK
        jsonb changes
        datetime created_at
    }

    %% ===== RELATIONSHIPS =====
    Organization ||--o{ UserGroup : "has"
    Organization ||--o{ Exhibition : "organizes"

    UserGroup ||--o{ GroupPermission : "has"
    UserGroup ||--o{ UserGroupMembership : "has members"
    UserGroup ||--o{ Zone : "manages (delegation)"
    UserGroup ||--o{ GameSession : "provides"

    User ||--o{ UserGroupMembership : "belongs to"
    User ||--o{ GameSession : "creates"
    User ||--o{ Booking : "books"
    User ||--o{ Media : "uploads"
    User ||--o{ ModerationComment : "writes"

    Exhibition ||--o{ TimeSlot : "has"
    Exhibition ||--o{ Zone : "contains"
    Exhibition ||--o{ SafetyTool : "defines"
    Exhibition ||--o{ GameSession : "hosts"

    Zone ||--o{ PhysicalTable : "contains"

    PhysicalTable ||--o{ GameSession : "hosts"

    TimeSlot ||--o{ GameSession : "schedules"

    GameCategory ||--o{ Game : "categorizes"
    Game ||--o{ GameSession : "played at"

    GameSession ||--o{ Booking : "has"
    GameSession ||--o{ ModerationComment : "has"
